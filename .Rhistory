gather(-Year, -State, -st, -RMeanDev, key = "Index", value = "Value") %>%
group_by(State) %>%
filter(State %in% c(input$state)) %>%
filter(Index %in% c(input$index_typep1_1)) %>%
filter(Year %in% c(x:y))
by_state_plot <- ggplot(by_state, aes(x = Year, y = Value)) +
geom_line(aes(color = Index)) +
geom_point() +
ylab("")
ggplotly(by_state_plot)
})
output$state_comparison <- renderPlotly({
a <- input$startyear1_2
b <- input$endyear1_2
by_state_comparison <- data %>%
filter(st != 0) %>%
gather(-Year, -State, -st, -RMeanDev, key = "Index", value = "Value") %>%
group_by(State) %>%
filter(State %in% c(input$state1, input$state2)) %>%
filter(Year %in% c(a:b))
plot_2 <- ggplot(data = by_state_comparison, aes(x = Year, y = Value)) +
geom_bar(aes(fill = Index), position = "dodge", stat = "identity") +
facet_wrap(~State) +
ggtitle(paste("Comparing", input$state1,"&", input$state2,
"between years", input$startyear1_2, "&", input$endyear1_2))
ggplotly(plot_2)
})
##Page two of the UI
## USA Inequality
output$nation_ineqality <- renderPlotly({
by_nation <- data %>%
filter(st == 0) %>%
gather(-Year, -State, -st, -RMeanDev,
key = "Index", value = "Value") %>%
filter(Index %in% c(input$index_typep2_1)) %>%
filter(Year %in% c(input$startyear2_1:input$endyear2_1))
nation_plot <- ggplot(by_nation, aes(x = Year, y = Value)) +
geom_line(aes(color = Index)) +
geom_point() +
ggtitle(paste("USA Inequality Analysis between", input$startyear2_1,
"&", input$endyear2_1)) + ylab("")
ggplotly(nation_plot)
})
## USA GDP
output$nation_GDP <- renderPlotly({
gdp <- read.csv("GDP.csv") %>%
filter(Year %in% c(1930:1945)) %>%
gather(key = "Type", value = "GDP", -Year)
gdp_plot <- gdp_plot <- ggplot(data = gdp, aes(x=Year, y=GDP)) +
geom_line()+
geom_point() +
ylab("GDP (in Trillions)")
ggplotly(gdp_plot)
})
}
library(shiny)
source("app_ui.R")
source("server_app.R")
shinyApp(ui = navui, server = server)
gdp <- read.csv("GDP.csv")
View(gdp)
colnames(gdp)
library(dplyr)
library(reshape2)
library(ggplot2)
library(plotly)
library(tidyr)
data <- read.csv("inequality_data.csv") %>%
rename("Year" = "ï..Year")
server <- function(input, output){
##Page one of the UI
output$by_state_inequality <- renderPlotly({
x <- input$startyear1_1
y <- input$endyear1_1
by_state <- data %>%
filter(st != 0) %>%
gather(-Year, -State, -st, -RMeanDev, key = "Index", value = "Value") %>%
group_by(State) %>%
filter(State %in% c(input$state)) %>%
filter(Index %in% c(input$index_typep1_1)) %>%
filter(Year %in% c(x:y))
by_state_plot <- ggplot(by_state, aes(x = Year, y = Value)) +
geom_line(aes(color = Index)) +
geom_point() +
ylab("")
ggplotly(by_state_plot)
})
output$state_comparison <- renderPlotly({
a <- input$startyear1_2
b <- input$endyear1_2
by_state_comparison <- data %>%
filter(st != 0) %>%
gather(-Year, -State, -st, -RMeanDev, key = "Index", value = "Value") %>%
group_by(State) %>%
filter(State %in% c(input$state1, input$state2)) %>%
filter(Year %in% c(a:b))
plot_2 <- ggplot(data = by_state_comparison, aes(x = Year, y = Value)) +
geom_bar(aes(fill = Index), position = "dodge", stat = "identity") +
facet_wrap(~State) +
ggtitle(paste("Comparing", input$state1,"&", input$state2,
"between years", input$startyear1_2, "&", input$endyear1_2))
ggplotly(plot_2)
})
##Page two of the UI
## USA Inequality
output$nation_ineqality <- renderPlotly({
by_nation <- data %>%
filter(st == 0) %>%
gather(-Year, -State, -st, -RMeanDev,
key = "Index", value = "Value") %>%
filter(Index %in% c(input$index_typep2_1)) %>%
filter(Year %in% c(input$startyear2_1:input$endyear2_1))
nation_plot <- ggplot(by_nation, aes(x = Year, y = Value)) +
geom_line(aes(color = Index)) +
geom_point() +
ggtitle(paste("USA Inequality Analysis between", input$startyear2_1,
"&", input$endyear2_1)) + ylab("")
ggplotly(nation_plot)
})
## USA GDP
output$nation_GDP <- renderPlotly({
gdp <- read.csv("GDP.csv") %>%
rename("Year" = "ï..Year")
filter(Year %in% c(1930:1945)) %>%
gather(key = "Type", value = "GDP", -Year)
gdp_plot <- gdp_plot <- ggplot(data = gdp, aes(x=Year, y=GDP)) +
geom_line()+
geom_point() +
ylab("GDP (in Trillions)")
ggplotly(gdp_plot)
})
}
library(shiny)
source("app_ui.R")
source("server_app.R")
shinyApp(ui = navui, server = server)
View(gdp)
colnames(gdp)
gdp <- read.csv("GDP.csv") %>%
rename("Year" = "ï..Year")
colnames(gdp)
gdp <- read.csv("GDP.csv") %>%
rename("Year" = "ï..Year")
filter(Year %in% c(1930:1945)) %>%
gather(key = "Type", value = "GDP", -Year)
gdp <- read.csv("GDP.csv") %>%
rename("Year" = "ï..Year") %>%
gather(key = "Type", value = "GDP", -Year)%>%
filter(Year %in% c(1930:1945))
gdp <- read.csv("GDP.csv") %>%
rename("Year" = "ï..Year") %>%
gather(key = "Type", value = "GDP", -Year)%>%
filter(Year %in% c(1930:1945))
library(dplyr)
library(reshape2)
library(ggplot2)
library(plotly)
library(tidyr)
data <- read.csv("inequality_data.csv") %>%
rename("Year" = "ï..Year")
server <- function(input, output){
##Page one of the UI
output$by_state_inequality <- renderPlotly({
x <- input$startyear1_1
y <- input$endyear1_1
by_state <- data %>%
filter(st != 0) %>%
gather(-Year, -State, -st, -RMeanDev, key = "Index", value = "Value") %>%
group_by(State) %>%
filter(State %in% c(input$state)) %>%
filter(Index %in% c(input$index_typep1_1)) %>%
filter(Year %in% c(x:y))
by_state_plot <- ggplot(by_state, aes(x = Year, y = Value)) +
geom_line(aes(color = Index)) +
geom_point() +
ylab("")
ggplotly(by_state_plot)
})
output$state_comparison <- renderPlotly({
a <- input$startyear1_2
b <- input$endyear1_2
by_state_comparison <- data %>%
filter(st != 0) %>%
gather(-Year, -State, -st, -RMeanDev, key = "Index", value = "Value") %>%
group_by(State) %>%
filter(State %in% c(input$state1, input$state2)) %>%
filter(Year %in% c(a:b))
plot_2 <- ggplot(data = by_state_comparison, aes(x = Year, y = Value)) +
geom_bar(aes(fill = Index), position = "dodge", stat = "identity") +
facet_wrap(~State) +
ggtitle(paste("Comparing", input$state1,"&", input$state2,
"between years", input$startyear1_2, "&", input$endyear1_2))
ggplotly(plot_2)
})
##Page two of the UI
## USA Inequality
output$nation_ineqality <- renderPlotly({
by_nation <- data %>%
filter(st == 0) %>%
gather(-Year, -State, -st, -RMeanDev,
key = "Index", value = "Value") %>%
filter(Index %in% c(input$index_typep2_1)) %>%
filter(Year %in% c(input$startyear2_1:input$endyear2_1))
nation_plot <- ggplot(by_nation, aes(x = Year, y = Value)) +
geom_line(aes(color = Index)) +
geom_point() +
ggtitle(paste("USA Inequality Analysis between", input$startyear2_1,
"&", input$endyear2_1)) + ylab("")
ggplotly(nation_plot)
})
## USA GDP
output$nation_GDP <- renderPlotly({
gdp <- read.csv("GDP.csv") %>%
rename("Year" = "ï..Year") %>%
gather(key = "Type", value = "GDP", -Year)%>%
filter(Year %in% c(1930:1945))
gdp_plot <- gdp_plot <- ggplot(data = gdp, aes(x=Year, y=GDP)) +
geom_line()+
geom_point() +
ylab("GDP (in Trillions)")
ggplotly(gdp_plot)
})
}
library(shiny)
source("app_ui.R")
source("server_app.R")
shinyApp(ui = navui, server = server)
library(dplyr)
library(reshape2)
library(ggplot2)
library(plotly)
library(tidyr)
data <- read.csv("inequality_data.csv") %>%
rename("Year" = "ï..Year")
server <- function(input, output){
##Page one of the UI
output$by_state_inequality <- renderPlotly({
x <- input$startyear1_1
y <- input$endyear1_1
by_state <- data %>%
filter(st != 0) %>%
gather(-Year, -State, -st, -RMeanDev, key = "Index", value = "Value") %>%
group_by(State) %>%
filter(State %in% c(input$state)) %>%
filter(Index %in% c(input$index_typep1_1)) %>%
filter(Year %in% c(x:y))
by_state_plot <- ggplot(by_state, aes(x = Year, y = Value)) +
geom_line(aes(color = Index)) +
geom_point() +
ylab("")
ggplotly(by_state_plot)
})
output$state_comparison <- renderPlotly({
a <- input$startyear1_2
b <- input$endyear1_2
by_state_comparison <- data %>%
filter(st != 0) %>%
gather(-Year, -State, -st, -RMeanDev, key = "Index", value = "Value") %>%
group_by(State) %>%
filter(State %in% c(input$state1, input$state2)) %>%
filter(Year %in% c(a:b))
plot_2 <- ggplot(data = by_state_comparison, aes(x = Year, y = Value)) +
geom_bar(aes(fill = Index), position = "dodge", stat = "identity") +
facet_wrap(~State) +
ggtitle(paste("Comparing", input$state1,"&", input$state2,
"between years", input$startyear1_2, "&", input$endyear1_2))
ggplotly(plot_2)
})
##Page two of the UI
## USA Inequality
output$nation_ineqality <- renderPlotly({
by_nation <- data %>%
filter(st == 0) %>%
gather(-Year, -State, -st, -RMeanDev,
key = "Index", value = "Value") %>%
filter(Index %in% c(input$index_typep2_1)) %>%
filter(Year %in% c(input$startyear2_1:input$endyear2_1))
nation_plot <- ggplot(by_nation, aes(x = Year, y = Value)) +
geom_line(aes(color = Index)) +
geom_point() +
ggtitle(paste("USA Inequality Analysis between", input$startyear2_1,
"&", input$endyear2_1)) + ylab("")
ggplotly(nation_plot)
})
## USA GDP
output$nation_GDP <- renderPlotly({
gdp <- read.csv("GDP.csv") %>%
rename("Year" = "ï..Year") %>%
gather(key = "Type", value = "GDP", -Year)%>%
filter(Year %in% c(input$startyear2_2:input$endyear2_2))
gdp_plot <- gdp_plot <- ggplot(data = gdp, aes(x=Year, y=GDP)) +
geom_line()+
geom_point() +
ylab("GDP (in Trillions)")
ggplotly(gdp_plot)
})
}
library(shiny)
source("app_ui.R")
source("server_app.R")
shinyApp(ui = navui, server = server)
library(dplyr)
library(reshape2)
library(ggplot2)
library(plotly)
library(shiny)
data <- read.csv("inequality_data.csv") %>%
rename("Year" = "ï..Year")
gdp <- read.csv("GDP.csv") %>%
rename("Year" = "ï..Year") %>%
filter(Year %in% c(1929:1945)) %>%
gather(key = "Type", value = "GDP", -Year)
gdp_plot <- ggplot(data = gdp, aes(x=Year, y=GDP)) +
geom_line()+
geom_point() +
ylab("GDP (in Trillions)")
ggplotly(gdp_plot)
national_inquality_analysis <- tabPanel(
"National Analysis",
# Styles the navbar text
tags$style(),
tags$body(
h1(
id = "headers",
"Tracking Inequality Indicies of the USA"
),
sidebarLayout(
sidebarPanel(
#Choose the start year for analysis
selectInput(
inputId = "startyear2_1",
label = "Choose start year",
choices = unique(data$Year),
selected = "1930"
),
#Choose the end year for analysis
selectInput(
inputId = "endyear2_1",
label = "Choose start year",
choices = unique(data$Year),
selected = "2015"
),
)
),
sidebarLayout(
sidebarPanel(
#Choose the start year for analysis
selectInput(
inputId = "startyear2_1",
label = "Choose start year",
choices = unique(data$Year),
selected = "1930"
),
#Choose the end year for analysis
selectInput(
inputId = "endyear2_1",
label = "Choose start year",
choices = unique(data$Year),
selected = "2015"
),
#Choose the index to be analyzed
checkboxGroupInput(
inputId = "index_typep2_1",
"Choose Index:",
choices = c(
"Theil" = "Theil",
"Gini" = "Gini",
"Atkin" = "Atkin05"),
selected = c("Theil")
)
),
mainPanel(
plotlyOutput("nation_ineqality", width = "100%")
),
),
),
tags$body(
h1(
id = "headers",
"Tracking Economic Growth (GDP) in the US"
),
sidebarLayout(
sidebarPanel(
#Choose the start year for analysis
selectInput(
inputId = "startyear2_2",
label = "Choose start year",
choices = unique(data$Year),
selected = "1930"
),
#Choose the end year for analysis
selectInput(
inputId = "endyear2_2",
label = "Choose start year",
choices = unique(data$Year),
selected = "2015"
)
),
mainPanel(
plotlyOutput("nation_GDP")
)
)
)
)
library(dplyr)
library(reshape2)
library(ggplot2)
library(plotly)
library(shiny)
data <- read.csv("inequality_data.csv") %>%
rename("Year" = "ï..Year")
gdp <- read.csv("GDP.csv") %>%
rename("Year" = "ï..Year") %>%
filter(Year %in% c(1929:1945)) %>%
gather(key = "Type", value = "GDP", -Year)
gdp_plot <- ggplot(data = gdp, aes(x=Year, y=GDP)) +
geom_line()+
geom_point() +
ylab("GDP (in Trillions)")
ggplotly(gdp_plot)
national_inquality_analysis <- tabPanel(
"National Analysis",
# Styles the navbar text
tags$style(),
tags$body(
h1(
id = "headers",
"Tracking Inequality Indicies of the USA"
),
sidebarLayout(
sidebarPanel(
#Choose the start year for analysis
selectInput(
inputId = "startyear2_1",
label = "Choose start year",
choices = unique(data$Year),
selected = "1930"
),
#Choose the end year for analysis
selectInput(
inputId = "endyear2_1",
label = "Choose start year",
choices = unique(data$Year),
selected = "2015"
),
),
mainPanel(),
),
sidebarLayout(
sidebarPanel(
#Choose the start year for analysis
selectInput(
inputId = "startyear2_1",
label = "Choose start year",
choices = unique(data$Year),
selected = "1930"
),
#Choose the end year for analysis
selectInput(
inputId = "endyear2_1",
label = "Choose start year",
choices = unique(data$Year),
selected = "2015"
),
#Choose the index to be analyzed
checkboxGroupInput(
inputId = "index_typep2_1",
"Choose Index:",
choices = c(
"Theil" = "Theil",
"Gini" = "Gini",
"Atkin" = "Atkin05"),
selected = c("Theil")
)
),
mainPanel(
plotlyOutput("nation_ineqality", width = "100%")
),
),
),
tags$body(
h1(
id = "headers",
"Tracking Economic Growth (GDP) in the US"
),
sidebarLayout(
sidebarPanel(
#Choose the start year for analysis
selectInput(
inputId = "startyear2_2",
label = "Choose start year",
choices = unique(data$Year),
selected = "1930"
),
#Choose the end year for analysis
selectInput(
inputId = "endyear2_2",
label = "Choose start year",
choices = unique(data$Year),
selected = "2015"
)
),
mainPanel(
plotlyOutput("nation_GDP")
)
)
)
)
library(shiny)
source("app_ui.R")
source("server_app.R")
shinyApp(ui = navui, server = server)
